<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Loja Virtual - Todos os Produtos</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #ccc;
      margin: 0;
      padding: 20px;
    }
	.banner img{
		width: 100%;
	}
    h1 {
      text-align: center;
      margin-bottom: 30px;
      color: #333;
    }
    .category-menu {
      background-color: #333;
      margin-bottom: 30px;
      border-radius: 5px;
      overflow: hidden;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      max-width: 1400px;
      margin-left: auto;
      margin-right: auto;
    }
    .category-menu ul {
      list-style: none;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
    }
    .category-menu a {
      display: block;
      padding: 15px 25px;
      text-decoration: none;
      color: white;
      font-weight: bold;
      font-size: 14px;
      text-transform: uppercase;
      transition: background-color 0.3s ease;
    }
    .category-menu a:hover {
      background-color: #555;
    }
    .container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
      max-width: 1400px;
      margin: 0 auto;
    }
    .product-card {
      background-color: #fff;
      border: 1px solid #e9e9e9;
      border-radius: 4px;
      text-align: center;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      transition: box-shadow 0.3s ease;
    }
    .product-card:hover { box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1); }
    a.product-link-wrapper, .product-name a {
      text-decoration: none;
      color: inherit;
    }
    .product-name a:hover { color: #007bff; }
    .product-image-container { position: relative; padding: 15px; background-color: #fff; }
    .product-image { width: 100%; height: 230px; object-fit: contain; } 
    .product-badges { position: absolute; top: 15px; right: 15px; display: flex; flex-direction: column; gap: 5px; }
    .badge { padding: 4px 8px; font-size: 11px; font-weight: bold; color: #fff; border-radius: 3px; text-transform: uppercase; }
    .badge-new { background-color: #dc3545; }
    .product-info { padding: 15px; border-top: 1px solid #f0f0f0; flex-grow: 1; display: flex; flex-direction: column; justify-content: space-between; }
    .product-category { font-size: 11px; color: #aaa; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 8px; }
    .product-name { font-size: 15px; font-weight: 600; color: #333; text-transform: uppercase; margin: 0; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .product-price { margin: 10px 0; }
    .current-price { font-size: 18px; font-weight: bold; color: #dc3545; }
    .product-rating { margin-bottom: 15px; font-size: 14px; color: #ffc107; }
    .product-actions { border-top: 1px solid #f0f0f0; padding: 12px 15px; display: flex; justify-content: center; gap: 25px; }
    .action-icon { font-size: 18px; color: #777; text-decoration: none; transition: color 0.2s ease; }
    .action-icon:hover { color: #007bff; }
  </style>
</head>
<body>
  <header class="banner">
	<a href="index.html">
		<img src="img/banner.png"/>
	</a>		
  </header>	
  <h1>Todos os Produtos</h1>

  <nav class="category-menu">
    <ul>
      <li><a href="categoria.html?categoria=Celulares">CELULARES</a></li>
      <li><a href="categoria.html?categoria=Eletr√¥nicos">ELETR√îNICOS</a></li>
      <li><a href="categoria.html?categoria=Inform√°tica">INFORM√ÅTICA</a></li>
      <li><a href="categoria.html?categoria=Perfumes">PERFUMES</a></li>
      <li><a href="categoria.html?categoria=Eletrodom√©sticos">ELETRODOM√âSTICOS</a></li>
    </ul>
  </nav>

  <div id="produtos" class="container">Carregando produtos...</div>

  <script>
    async function loadProducts() {
      try {
        const response = await fetch('http://localhost/API-Loja/api.php/produtos/');
        if (!response.ok) {
          throw new Error("Erro ao carregar produtos. Status: " + response.status);
        }
        
        const produtos = await response.json();
        const container = document.getElementById('produtos');
        container.innerHTML = ""; 

        if (produtos.length === 0) {
            container.innerHTML = `<p style="text-align: center; grid-column: 1 / -1;">Nenhum produto encontrado.</p>`;
            return;
        }

        produtos.forEach(produto => {
          const card = document.createElement('div');
          card.className = 'product-card';

          const imagemNome = (produto.imagem && produto.imagem !== 'no-image.jpg')
            ? produto.imagem
            : 'no-image.jpg';
          const imgSrc = `img/${imagemNome}`;

          const precoFormatado = Number(produto.valor).toLocaleString('pt-BR', {
            style: 'currency',
            currency: 'BRL'
          });

          let newBadgeHtml = '';
          const dataCriado = new Date(produto.data_criado);
          const today = new Date();
          const diffTime = Math.abs(today - dataCriado);
          const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

          if (diffDays <= 7) { 
            newBadgeHtml = '<span class="badge badge-new">NEW</span>';
          }

          card.innerHTML = `
            <a href="produto.html?id=${produto.id}" class="product-link-wrapper">
              <div class="product-image-container">
                <img src="${imgSrc}" alt="${produto.nome}" class="product-image">
                <div class="product-badges">
                  ${newBadgeHtml}
                </div>
              </div>
            </a>

            <div class="product-info">
              <div>
                <div class="product-category">${produto.categoria}</div>
                <h3 class="product-name" title="${produto.nome}">
                  <a href="produto.html?id=${produto.id}">${produto.nome}</a>
                </h3>
                <div class="product-price">
                  <span class="current-price">${precoFormatado}</span>
                </div>
                <div class="product-rating">
                  <span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span><span>‚òÜ</span>
                </div>
              </div>
              <div class="product-actions">
                <a href="#" class="action-icon" title="Adicionar aos Favoritos">‚ô°</a>
                <a href="#" class="action-icon" title="Comparar">‚áÜ</a>
                <a href="#" class="action-icon" title="Visualiza√ß√£o R√°pida">üëÅ</a>
              </div>
            </div>
          `;
          
          container.appendChild(card);
        });
      } catch (e) {
        document.getElementById('produtos').innerHTML = `<p style="text-align: center; color: red; grid-column: 1 / -1;">Erro ao carregar produtos: ${e.message}</p>`;
        console.error(e);
      }
    }

    loadProducts();
  </script>
</body>
</html>